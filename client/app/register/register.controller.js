// Generated by CoffeeScript 1.9.2
(function() {
  'use strict';
  angular.module('moneyApp').controller('RegisterCtrl', function($scope, $log, $http, $location) {
    var tag;
    tag = 'RegisterCtrl';
    $scope.checkEmail;
    $scope.register = function() {
      $log.log(tag, 'register()');
      $log.log(tag, 'form.$invalid:', $scope.form.$invalid);
      $scope.trySubmit = true;
      if ($scope.form.$invalid) {
        return $scope.user;
      }
      $scope.helpMsg = '요청중...';
      return $http.post('/api/users', {
        email: $scope.user.email,
        pass: $scope.user.pass
      }).success(function(data) {
        $log.info(tag, data);
        $scope.helpMsg = '등록완료';
        return $location.url('/login?tryEmail=' + data.email);
      }).error(function(error) {
        $log.error(tag, error);
        if (error.name === 'SequelizeUniqueConstraintError') {
          return $scope.helpMsg = '이미 등록된 이메일';
        } else {
          return $scope.helpMsg = '등록실패';
        }
      });
    };
    return $scope.showError = function(form, validator, trySubmit) {
      var result;
      $log.debug(tag, 'showError()');
      $log.debug(tag, 'form.$error[validator]', form.$error[validator]);
      result = trySubmit && form.$error && form.$error[validator];
      $log.debug(tag, 'result: ', result);
      return result;
    };
  });

}).call(this);

//# sourceMappingURL=register.controller.js.map
